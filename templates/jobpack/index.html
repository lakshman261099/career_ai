{% extends "base.html" %}
{% block title %}Job Pack â€” CareerAI{% endblock %}

{% block content %}
<section class="mx-auto max-w-4xl px-4 sm:px-6 lg:px-8 pt-12 space-y-6">
  <div class="glass-panel rounded-2xl p-6">
    <div class="flex items-center justify-between mb-3">
      <div>
        <h1 class="text-xl font-bold">Job Pack</h1>
        <p class="text-sm text-white/70">
          Paste a job description. Weâ€™ll combine it with your Profile Portal to analyze fit, ATS score, and exact fixes.
        </p>
      </div>
      <a href="{{ url_for('jobpack.history') }}"
         class="text-xs text-white/70 hover:text-white underline">
        View past Job Packs
      </a>
    </div>

    {% if profile_snapshot %}
      <div class="mt-3 mb-4 text-xs text-white/70 flex flex-wrap items-center gap-2">
        <span class="px-2 py-1 rounded-full bg-white/5 border border-white/15">
          Profile Portal: {{ profile_snapshot.profile_strength_score or 0 }}% complete
        </span>
        {% if profile_snapshot.missing_sections %}
          <span class="text-white/60">
            Missing: {{ profile_snapshot.missing_sections | join(', ') }}
          </span>
        {% endif %}
        <a href="{{ url_for('settings.profile') }}"
           class="text-[11px] underline hover:text-white ml-auto">
          Update Profile Portal â†’
        </a>
      </div>
    {% endif %}

    <!-- Token balances -->
    <div class="text-[11px] text-white/60 mb-3">
      Balance:
      <span class="font-semibold">{{ user_free|default(0) }} ğŸª™ Silver</span> Â·
      <span class="font-semibold">{{ user_pro|default(0) }} â­ Gold</span>
    </div>

    <form method="POST">
      <label class="block text-sm mb-1">Job Description (paste)</label>
      <textarea name="jd" rows="8"
        class="w-full rounded-xl px-3 py-2 bg-white/10 border border-white/20 focus:outline-none focus:ring-2 focus:ring-emerald-400/70"
        required></textarea>

      <p class="text-[11px] text-white/50 mt-2">
        We automatically use your Profile Portal / latest uploaded resume as the candidate profile.
        You donâ€™t need to paste your resume here.
      </p>

      <!-- Mode selection with per-run costs -->
      <div class="mt-4 flex items-center gap-6 text-sm">
        <label class="inline-flex items-center gap-2">
          <input type="radio" name="mode" value="basic" {% if mode != 'pro' %}checked{% endif %}>
          <span class="flex flex-col leading-tight">
            <span>Basic (ğŸª™)</span>
            <span class="text-[10px] text-white/70">1 Silver ğŸª™ / run</span>
          </span>
        </label>

        <label class="inline-flex items-center gap-2">
          <input type="radio" name="mode" value="pro" {% if mode == 'pro' %}checked{% endif %}>
          <span class="flex flex-col leading-tight">
            <span>Deep (Pro â­)</span>
            <span class="text-[10px] text-white/70">3 Gold â­ / run</span>
          </span>
        </label>
      </div>

      <div class="mt-4 flex flex-wrap gap-2 items-center">
        <button class="btn-primary" type="submit">Analyze</button>
        <a class="btn-ghost" href="{{ feature_paths.billing }}">Get Pro</a>
        <p class="text-[11px] text-white/50 ml-1">
          Basic uses <span class="font-semibold">1 Silver ğŸª™</span> per run.
          Deep uses <span class="font-semibold">3 Gold â­</span> per run.
        </p>
      </div>
    </form>
  </div>
</section>
{% endblock %}
