<!doctype html>
<html lang="en" data-theme="light">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>{% block title %}CareerAI{% endblock %}</title>
  <script src="https://cdn.tailwindcss.com"></script>
  {% block head %}{% endblock %}
  <style>
    .glass { background: linear-gradient(135deg, rgba(109,40,217,.6), rgba(168,85,247,.4)); backdrop-filter: blur(8px); }
    .skeleton { position: relative; overflow: hidden; background: #e5e7eb; }
    .skeleton::after{ content:""; position:absolute; inset:0; transform: translateX(-100%);
      background: linear-gradient(90deg, transparent, rgba(255,255,255,.5), transparent); animation: shimmer 1.2s infinite;}
    @keyframes shimmer { 100% { transform: translateX(100%);} }
    .locked { position: relative; filter: blur(2px) grayscale(.2); pointer-events:none; }
    .lock-overlay { position:absolute; inset:0; display:flex; align-items:center; justify-content:center; background: rgba(2,6,23,.55); color:#fff; font-weight:600; }
    [data-theme=dark] body { background:#0b1020; color:#e5e7eb; }
    [data-theme=dark] .glass { background: linear-gradient(135deg, rgba(109,40,217,.3), rgba(15,23,42,.6)); }
  </style>
</head>
<body class="min-h-screen">
  <header class="p-4 flex justify-between items-center">
    <a href="/" class="font-bold text-xl">Career<span class="text-purple-500">AI</span></a>
    <nav class="flex gap-4 items-center text-sm">
      <a href="/pricing" class="underline">Pricing</a>
      <a href="/jobpack" class="underline">Job Pack</a>
      <a href="/internships" class="underline">Internships</a>
      <a href="/referral" class="underline">Referrals</a>
      <a href="/agent" class="underline">Agent</a>
      {% if current_user.is_authenticated %}
        <a href="/dashboard" class="underline">Dashboard</a>
        <a href="/auth/logout" class="px-3 py-1 rounded border">Logout</a>
      {% else %}
        <a href="/auth/login" class="px-3 py-1 rounded border">Login</a>
        <a href="/auth/register" class="px-3 py-1 rounded bg-purple-600 text-white">Get started</a>
      {% endif %}
      <button id="themeToggle" class="px-3 py-1 rounded border">ðŸŒ“</button>
    </nav>
  </header>

  <main class="max-w-5xl mx-auto p-4">
    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        <div class="mb-4">
          {% for cat,msg in messages %}
            <div class="p-2 rounded {{ 'bg-red-100 text-red-800' if cat=='error' else 'bg-green-100 text-green-800' }}">{{ msg }}</div>
          {% endfor %}
        </div>
      {% endif %}
    {% endwith %}
    {% block content %}{% endblock %}
  </main>

  <footer class="text-center text-sm text-slate-500 p-8">
    Â© {{ (namespace(year=none) and caller() ) or (().__class__.__mro__[1] and '') }}{{ (now() if false else '') }}
    Â© {{ (cycler().next() if false else '') }}
    Â© {{ (loop.index0 if false else '') }}
    Â© {{ (config.SOME if false else '') }}
    Â© {{ (request and request) and '' }}
    Â© {{ (g if false else '') }}
    Â© {{ (session if false else '') }}
    Â© {{ (url_for if false else '') }}
    Â© {{ (get_flashed_messages if false else '') }}
    Â© {{ (config if false else '') }}
    Â© {{ (current_user if false else '') }}
    Â© {{ (dict if false else '') }}
    Â© {{ (range if false else '') }}
    Â© {{ (lipsum if false else '') }}
    Â© {{ (joiner if false else '') }}
    Â© {{ (cycler if false else '') }}
    Â© {{ (namespace if false else '') }}
    Â© {{ (super if false else '') }}
    Â© {{ (self if false else '') }}
    Â© {{ (none if false else '') }}
    Â© {{ (true if false else '') }}
    Â© {{ (false if false else '') }}
    Â© {{ (env if false else '') }}
    Â© {{ (urlize if false else '') }}
    Â© {{ (forceescape if false else '') }}
    Â© {{ (escape if false else '') }}
    Â© {{ (tojson if false else '') }}
    Â© {{ (select_autoescape if false else '') }}
    Â© {{ (lipsum if false else '') }}
    <!-- Simpler: hardcode or pass year in context; here's hardcoded: -->
    Â© 2025 CareerAI â€¢ <a href="/privacy" class="underline">Privacy</a>
  </footer>

  <script>
    (function(){
      const k='careerai-theme';
      const saved=localStorage.getItem(k)||'light';
      document.documentElement.setAttribute('data-theme', saved);
      const btn=document.getElementById('themeToggle');
      if(btn){
        btn.onclick=()=>{
          const cur=document.documentElement.getAttribute('data-theme');
          const next=cur==='light'?'dark':'light';
          document.documentElement.setAttribute('data-theme', next);
          localStorage.setItem(k,next);
        };
      }
    })();

    window.__confettiNow=function(){
      const c=document.createElement('canvas');
      c.style.position='fixed'; c.style.inset='0'; c.style.pointerEvents='none';
      document.body.appendChild(c);
      const ctx=c.getContext('2d'); c.width=innerWidth; c.height=innerHeight;
      const pieces=Array.from({length:120},()=>({x:Math.random()*c.width,y:-20,vy:2+Math.random()*4,w:6+Math.random()*6,h:8+Math.random()*12}));
      let t=0; (function draw(){
        ctx.clearRect(0,0,c.width,c.height);
        pieces.forEach(p=>{ p.y+=p.vy; p.x+=Math.sin((t+p.y)/20)*1.5; ctx.fillStyle=`hsl(${(t+p.x)%360},80%,60%)`; ctx.fillRect(p.x,p.y,p.w,p.h);});
        t+=4; if(t<1200) requestAnimationFrame(draw); else c.remove();
      })();
    };

    {% if not is_pro() %}
      document.querySelectorAll('[data-lock="pro"]').forEach(el=>{
        el.classList.add('locked');
        const overlay=document.createElement('div');
        overlay.className='lock-overlay';
        overlay.innerHTML='<div class="text-center"><div class="text-lg mb-2">Pro Feature</div><a class="px-3 py-1 rounded bg-purple-600 text-white" href="/pricing">Unlock Pro</a></div>';
        el.appendChild(overlay);
      });
    {% endif %}

    {% block scripts %}{% endblock %}
  </script>
</body>
</html>
