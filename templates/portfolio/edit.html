{% extends "base.html" %}
{% block title %}Edit Draft — CareerAI{% endblock %}
{% block content %}
<section class="mx-auto max-w-3xl px-4 sm:px-6 lg:px-8 pt-12">
  <div class="glass-panel rounded-2xl p-6">
    <div class="flex items-start justify-between">
      <h1 class="text-xl font-bold mb-3">Edit Draft</h1>
      {% if page.is_public %}
        <a href="{{ url_for('portfolio.view', page_id=page.id) }}" target="_blank" rel="noopener" class="btn-ghost">View public link →</a>
      {% endif %}
    </div>

    <p class="text-xs text-white/60 mb-4">Saving counts toward your daily limit.</p>

    <form method="POST">
      <label class="block text-sm mb-1">Title</label>
      <input name="title" value="{{ page.title }}" class="w-full rounded-xl px-3 py-2 bg-white/10 border border-white/20">

      <label class="block text-sm mt-4 mb-1">Content (Markdown)</label>
      <textarea name="content_md" rows="12" class="w-full rounded-xl px-3 py-2 bg-white/10 border border-white/20">{{ page.content_md }}</textarea>

      <div class="mt-4 flex gap-2">
        <button class="btn-primary" type="submit">Update Draft</button>
        <a class="btn-ghost" href="{{ url_for('portfolio.index') }}">Back</a>
        {% if not page.is_public %}
          <form method="POST" action="{{ url_for('portfolio.publish', page_id=page.id) }}"></form>
        {% endif %}
      </div>
    </form>

    {% if not page.is_public %}
      <form class="mt-3" method="POST" action="{{ url_for('portfolio.publish', page_id=page.id) }}">
        <button class="btn-ghost" type="submit">Publish ⭐</button>
      </form>
    {% else %}
      <form class="mt-3" method="POST" action="{{ url_for('portfolio.unpublish', page_id=page.id) }}">
        <button class="btn-ghost" type="submit">Unpublish</button>
      </form>
    {% endif %}
  </div>
</section>
{% endblock %}
