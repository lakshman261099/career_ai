{% extends "base.html" %}
{% block title %}Job Pack – CareerAI{% endblock %}
{% block content %}
<h1 class="text-2xl font-semibold mb-4">Job Pack ({{ pack.meta.analysis_mode|default('fast')|title }})</h1>

{% set verdict = pack.overall_verdict or {} %}
<div class="grid md:grid-cols-3 gap-4">
  <div class="md:col-span-2 space-y-4">
    <div class="border rounded p-4">
      <h2 class="font-semibold mb-2">Summary</h2>
      <div class="text-sm">{{ verdict.summary or '—' }}</div>
      <div class="mt-2 text-sm">
        <b>Status:</b> {{ verdict.status or '—' }}
      </div>
    </div>

    <div class="border rounded p-4">
      <h2 class="font-semibold mb-2">Tailored resume bullets</h2>
      <ul class="list-disc pl-5 text-sm space-y-1">
        {% for b in pack.tailored_resume_bullets or [] %}
          <li>{{ b }}</li>
        {% endfor %}
      </ul>
    </div>

    <div class="border rounded p-4">
      <h2 class="font-semibold mb-2">Interview questions</h2>
      <div class="space-y-2">
        {% for q in pack.interview_questions or [] %}
          <div class="border rounded p-3">
            <div class="text-sm font-semibold">{{ q.question }}</div>
            <div class="text-xs italic text-slate-500 mb-1">{{ q.type|title }}</div>
            <div class="text-sm">{{ q.sample_answer }}</div>
          </div>
        {% endfor %}
      </div>
    </div>

    <div class="border rounded p-4">
      <h2 class="font-semibold mb-2">Follow-up actions</h2>
      <ul class="list-disc pl-5 text-sm space-y-1">
        {% for a in pack.follow_up_actions or [] %}<li>{{ a }}</li>{% endfor %}
      </ul>
    </div>

    <div class="border rounded p-4">
      <h2 class="font-semibold mb-2">Cover letter (draft)</h2>
      <div class="text-sm whitespace-pre-wrap">{{ pack.cover_letter }}</div>
    </div>
  </div>

  <div class="space-y-4">
    <div class="border rounded p-4">
      <h3 class="font-semibold mb-2">Scores</h3>
      {% for k,v in (pack.scores or {}).items() %}
        <div class="mb-2">
          <div class="text-sm font-medium">{{ k|replace('_',' ')|title }}</div>
          <div class="text-xs text-slate-500">{{ (v.notes or [])|join(' • ') }}</div>
          <div class="text-sm mt-1">Score: <b>{{ v.score }}</b></div>
        </div>
      {% endfor %}
    </div>

    <div class="border rounded p-4">
      <h3 class="font-semibold mb-2">Missing skills</h3>
      <div class="text-sm">{{ (pack.missing_skills or [])|join(', ') or '—' }}</div>
    </div>

    {% if report_id %}
      <a class="w-full block text-center px-4 py-2 border rounded" href="/jobpack/export_pdf/{{ report_id }}">Export PDF</a>
    {% endif %}
  </div>
</div>
{% endblock %}
