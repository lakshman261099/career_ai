{% extends "base.html" %}
{% block title %}Dashboard ‚Äî {{ tenant_name or 'CareerAI' }}{% endblock %}

{% block content %}
<section class="relative overflow-hidden">
  <!-- Animated background layer behind the dashboard (still under base.html gradient) -->
  <div class="pointer-events-none absolute inset-0 -z-10">
    <div class="w-full h-full opacity-60 animate-caGradient
                bg-[radial-gradient(circle_at_top_left,#f97316_0,transparent_55%),radial-gradient(circle_at_bottom_right,#6366f1_0,transparent_55%)]">
    </div>
  </div>

  <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-12 space-y-10">
    <!-- Hero / Welcome -->
    <header class="space-y-4">
      <div class="flex flex-wrap items-center justify-between gap-3">
        <div class="space-y-1">
          <p class="text-xs text-white/60 uppercase tracking-[0.16em]">
            Dashboard
          </p>
          <h1 class="text-3xl sm:text-4xl font-extrabold tracking-tight">
            Welcome{% if current_user.is_authenticated %}, {{ current_user.email }}{% endif %}
          </h1>
          <p class="text-sm sm:text-base text-slate-200 max-w-xl">
            Use these five tools together as your AI career control center ‚Äî map your skills, decode jobs,
            design projects, and reach warm referrals. Everything works best when your Profile Portal is complete.
          </p>
        </div>
        <div class="flex flex-col items-end gap-2 text-xs">
          <a href="{{ feature_paths.profile }}"
             class="inline-flex items-center gap-2 px-3 py-1.5 rounded-full bg-white/5 border border-white/15 text-slate-100 hover:bg-white/10 transition">
            <span class="text-[11px] px-1.5 py-0.5 rounded-full bg-emerald-500/15 border border-emerald-400/60 text-emerald-200">
              Profile Portal
            </span>
            <span class="hidden sm:inline text-slate-200/90">
              Start here ¬∑ filled once, used everywhere
            </span>
          </a>
          <p class="text-[10px] text-white/40">
            Step 1 for every student: complete your Profile Portal. Then use the tools below.
          </p>
        </div>
      </div>

      <!-- Simple ‚Äúhow to use the app‚Äù strip (dashboard-specific) -->
      <div class="glass-card rounded-2xl px-4 py-3 text-[11px] text-white/70 mt-2">
        <p class="font-semibold text-white/80 mb-1">Your career path with CareerAI:</p>
        <div class="flex flex-wrap gap-x-3 gap-y-1">
          <span>1) <strong>Profile Portal</strong> ‚Äî add your basics, skills &amp; projects</span>
          <span>‚Üí 2) <strong>Skill Mapper</strong> ‚Äî pick one target role</span>
          <span>‚Üí 3) <strong>Portfolio</strong> ‚Äî build projects for that role</span>
          <span>‚Üí 4) <strong>Job Packs &amp; Internship Analyzer</strong> ‚Äî compare real JDs &amp; internships</span>
          <span>‚Üí 5) <strong>Referral Trainer</strong> ‚Äî reach people for those roles</span>
        </div>
      </div>

      {# Credits & Plan card #}
      <div class="mt-3 grid gap-3 md:grid-cols-[minmax(0,1.7fr)_minmax(0,1.3fr)]">
        <div class="glass-card rounded-2xl px-4 py-3 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 text-[12px]">
          <div class="space-y-1">
            <p class="uppercase tracking-[0.16em] text-[10px] text-white/60">
              Credits &amp; plan
            </p>
            {% set plan = (subscription_status or 'free')|lower %}
            <div class="flex flex-wrap items-center gap-2">
              <span class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full border text-[10px] uppercase tracking-widest
                            {% if plan == 'pro' %}
                              bg-emerald-500/15 border-emerald-300/70 text-emerald-100
                            {% else %}
                              bg-slate-900/80 border-slate-400/60 text-slate-100
                            {% endif %}">
                {{ 'Pro' if plan == 'pro' else 'Free' }}
              </span>
              <span class="text-white/60 text-[11px]">
                Use Silver ü™ô for free tools and Gold ‚≠ê for Pro features.
              </span>
            </div>
          </div>
          <div class="flex flex-wrap items-center gap-3">
            <div class="flex items-center gap-2 px-2.5 py-1.5 rounded-full bg-slate-900/80 border border-slate-500/60">
              <span class="text-base">ü™ô</span>
              <div class="flex flex-col leading-tight">
                <span class="text-[11px] text-slate-300/80 uppercase tracking-[0.16em]">Silver</span>
                <span class="text-sm font-semibold">{{ user_free or 0 }}</span>
              </div>
            </div>
            <div class="flex items-center gap-2 px-2.5 py-1.5 rounded-full bg-slate-900/80 border border-slate-500/60">
              <span class="text-base">‚≠ê</span>
              <div class="flex flex-col leading-tight">
                <span class="text-[11px] text-slate-300/80 uppercase tracking-[0.16em]">Gold</span>
                <span class="text-sm font-semibold">{{ user_pro or 0 }}</span>
              </div>
            </div>
            <a href="{{ feature_paths.billing }}"
               class="btn-ghost text-[11px] whitespace-nowrap">
              Open Coins Shop
            </a>
          </div>
        </div>

        {# Extra nudge on dashboard if not verified #}
        {% if current_user.is_authenticated and not current_user.verified %}
          <div class="glass-card rounded-2xl px-4 py-3 border border-amber-400/60 text-xs sm:text-sm text-amber-100">
            <div class="flex flex-wrap items-center justify-between gap-2">
              <div>
                <p class="font-semibold">Finish email verification to use all AI features.</p>
                <p class="text-amber-100/80 text-[11px] sm:text-xs">
                  You can open every page now. When you click ‚ÄúAnalyze‚Äù or ‚ÄúGenerate‚Äù, we‚Äôll ask for a one-time email code.
                </p>
              </div>
              <a href="{{ url_for('auth.otp_request') }}"
                 class="btn-primary text-xs whitespace-nowrap">
                Get login code
              </a>
            </div>
          </div>
        {% endif %}
      </div>
    </header>

    <!-- Features zig-zag -->
    <div class="space-y-10">
      <!-- 1. Skill Mapper (left) -->
      <div class="ca-feature-row ca-feature-left">
        <article class="ca-feature-card">
          <div class="ca-feature-icon bg-gradient-to-tr from-violet-500 to-indigo-400">
            <span class="text-xl">‚òç</span>
          </div>
          <div class="space-y-1.5">
            <h2 class="text-lg font-semibold">Skill Mapper</h2>
            <p class="text-slate-200 text-sm">
              Uses your Profile Portal and latest resume to suggest 3 best-fit roles with India demand and sample salaries. Start here after filling your profile.
            </p>
          </div>
          <div class="flex flex-wrap items-center gap-2 text-xs text-slate-200/90">
            <span class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-violet-500/15 border border-violet-400/40">
              <span class="text-[10px]">‚òÖ</span> India demand
            </span>
            <span class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-sky-500/15 border border-sky-400/40">
              ‚Çπ salaries (0‚Äì3 YOE)
            </span>
          </div>
          <div class="pt-2">
            <a href="{{ feature_paths.skillmapper }}" class="ca-feature-cta">
              Open Skill Mapper
            </a>
          </div>

          <div class="ca-feature-detail ca-feature-detail-left">
            <h3 class="text-sm font-semibold mb-1.5 text-white">What you‚Äôll see</h3>
            <ul class="space-y-1.5 text-xs text-slate-100/90">
              <li>‚Ä¢ Top 3 roles ranked by fit from your skills snapshot</li>
              <li>‚Ä¢ Skills you already have vs gaps for each role</li>
              <li>‚Ä¢ India hiring demand &amp; salary hints per role</li>
              <li>‚Ä¢ Micro-project ideas to close the biggest gaps</li>
            </ul>
          </div>
        </article>
      </div>

      <!-- 2. Job Packs (right) -->
      <div class="ca-feature-row ca-feature-right">
        <article class="ca-feature-card">
          <div class="ca-feature-icon bg-gradient-to-tr from-emerald-500 to-teal-400">
            <span class="text-xl">üìÑ</span>
          </div>
          <div class="space-y-1.5">
            <h2 class="text-lg font-semibold">Job Pack</h2>
            <p class="text-slate-200 text-sm">
              Paste a JD. Get ATS score, missing keywords, interview Q&amp;A, and a full prep plan. Your Profile Portal resume and skills are auto-read for better matching.
            </p>
          </div>
          <div class="flex flex-wrap items-center gap-2 text-xs text-slate-200/90">
            <span class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-emerald-500/15 border border-emerald-400/40">
              ‚úÖ Resume checklist
            </span>
            <span class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-indigo-500/15 border border-indigo-400/40">
              üéØ Interview drills
            </span>
          </div>
          <div class="pt-2">
            <a href="{{ feature_paths.jobpack }}" class="ca-feature-cta">
              Analyze a job
            </a>
          </div>

          <div class="ca-feature-detail ca-feature-detail-right">
            <h3 class="text-sm font-semibold mb-1.5 text-white">What you‚Äôll see</h3>
            <ul class="space-y-1.5 text-xs text-slate-100/90">
              <li>‚Ä¢ ATS score with exact phrases to add to your resume</li>
              <li>‚Ä¢ Matched vs missing skills and tools</li>
              <li>‚Ä¢ Role-specific interview questions &amp; model answers</li>
              <li>‚Ä¢ 7-day prep plan tailored to that JD</li>
            </ul>
          </div>
        </article>
      </div>

      <!-- 3. Portfolio Builder (left) -->
      <div class="ca-feature-row ca-feature-left">
        <article class="ca-feature-card">
          <div class="ca-feature-icon bg-gradient-to-tr from-fuchsia-500 to-rose-400">
            <span class="text-xl">üöÄ</span>
          </div>
          <div class="space-y-1.5">
            <h2 class="text-lg font-semibold">Portfolio Builder</h2>
            <p class="text-slate-200 text-sm">
              Convert your skills into standout project ideas with impact bullets and tech stack suggestions. Pulls directly from your Profile Portal skills &amp; projects.
            </p>
          </div>
          <div class="flex flex-wrap items-center gap-2 text-xs text-slate-200/90">
            <span class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-fuchsia-500/15 border border-fuchsia-400/40">
              üìå Recruiter-ready bullets
            </span>
            <span class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-slate-100/10 border border-slate-400/40">
              üåê Public portfolio link (Pro)
            </span>
          </div>
          <div class="pt-2">
            <a href="{{ feature_paths.portfolio }}" class="ca-feature-cta">
              Design a project
            </a>
          </div>

          <div class="ca-feature-detail ca-feature-detail-left">
            <h3 class="text-sm font-semibold mb-1.5 text-white">What you‚Äôll see</h3>
            <ul class="space-y-1.5 text-xs text-slate-100/90">
              <li>‚Ä¢ 1‚Äì3 project ideas matched to your target role</li>
              <li>‚Ä¢ Recommended tech stack with beginner-friendly options</li>
              <li>‚Ä¢ Impact bullets you can paste into your resume</li>
              <li>‚Ä¢ Pro: publish a clean portfolio page from your profile</li>
            </ul>
          </div>
        </article>
      </div>

      <!-- 4. Internship Analyzer (right) -->
      <div class="ca-feature-row ca-feature-right">
        <article class="ca-feature-card">
          <div class="ca-feature-icon bg-gradient-to-tr from-sky-500 to-cyan-400">
            <span class="text-xl">üéì</span>
          </div>
          <div class="space-y-1.5">
            <h2 class="text-lg font-semibold">Internship Analyzer</h2>
            <p class="text-slate-200 text-sm">
              Paste any internship description. See what you‚Äôll learn, portfolio impact, and next roles it opens. Tailors advice based on your Profile Portal goals.
            </p>
          </div>
          <div class="flex flex-wrap items-center gap-2 text-xs text-slate-200/90">
            <span class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-sky-500/15 border border-sky-400/40">
              üìà Skill growth
            </span>
            <span class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-emerald-500/15 border border-emerald-400/40">
              üîÅ Pathway after internship
            </span>
          </div>
          <div class="pt-2">
            <a href="{{ feature_paths.internships }}" class="ca-feature-cta">
              Evaluate an internship
            </a>
          </div>

          <div class="ca-feature-detail ca-feature-detail-right">
            <h3 class="text-sm font-semibold mb-1.5 text-white">What you‚Äôll see</h3>
            <ul class="space-y-1.5 text-xs text-slate-100/90">
              <li>‚Ä¢ Concrete skills you‚Äôll build (tools + concepts)</li>
              <li>‚Ä¢ How it boosts your resume and portfolio</li>
              <li>‚Ä¢ Likely next roles after 6‚Äì18 months</li>
              <li>‚Ä¢ Whether it matches your long-term direction</li>
            </ul>
          </div>
        </article>
      </div>

      <!-- 5. Referral Trainer (left) -->
      <div class="ca-feature-row ca-feature-left">
        <article class="ca-feature-card">
          <div class="ca-feature-icon bg-gradient-to-tr from-amber-500 to-orange-400">
            <span class="text-xl">üì®</span>
          </div>
          <div class="space-y-1.5">
            <h2 class="text-lg font-semibold">Referral Trainer</h2>
            <p class="text-slate-200 text-sm">
              Draft warm, respectful outreach to alumni and employees ‚Äî without sounding robotic or salesy.
            </p>
          </div>
          <div class="flex flex-wrap items-center gap-2 text-xs text-slate-200/90">
            <span class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-amber-500/15 border border-amber-400/40">
              üí¨ Warm, cold &amp; follow-ups
            </span>
            <span class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-slate-100/10 border border-slate-400/40">
              ü™ô Free feature
            </span>
          </div>
          <div class="pt-2">
            <a href="{{ feature_paths.referral }}" class="ca-feature-cta">
              Draft a message
            </a>
          </div>

          <div class="ca-feature-detail ca-feature-detail-left">
            <h3 class="text-sm font-semibold mb-1.5 text-white">What you‚Äôll see</h3>
            <ul class="space-y-1.5 text-xs text-slate-100/90">
              <li>‚Ä¢ 3 outreach drafts: warm, cold, and follow-up</li>
              <li>‚Ä¢ Student-friendly tone (no cringe, no hype)</li>
              <li>‚Ä¢ Clear subject line + LinkedIn opener</li>
              <li>‚Ä¢ Easy spots to personalize in 10‚Äì15 seconds</li>
            </ul>
          </div>
        </article>
      </div>
    </div>
  </div>
</section>
{% endblock %}

{% block scripts %}
<style>
  /* Subtle animated gradient in background */
  @keyframes caGradient {
    0%   { transform: translate3d(0,0,0) scale(1); }
    50%  { transform: translate3d(-3%, -4%, 0) scale(1.03); }
    100% { transform: translate3d(0,0,0) scale(1); }
  }
  .animate-caGradient {
    animation: caGradient 26s ease-in-out infinite;
  }

  /* Feature rows (zig-zag left/right) */
  .ca-feature-row {
    position: relative;
    display: flex;
    justify-content: flex-start;
  }
  .ca-feature-row.ca-feature-right {
    justify-content: flex-end;
  }

  /* Core feature card */
  .ca-feature-card {
    position: relative;
    width: 100%;
    max-width: 480px;
    padding: 1.5rem 1.6rem;
    border-radius: 1.4rem;
    background:
      radial-gradient(circle at top left, rgba(148,163,253,0.25), transparent 55%),
      radial-gradient(circle at bottom right, rgba(249,115,22,0.18), transparent 55%),
      rgba(15,23,42,0.95);
    border: 1px solid rgba(148,163,184,0.45);
    box-shadow: 0 22px 44px rgba(15,23,42,0.9);
    display: flex;
    flex-direction: column;
    gap: 0.85rem;
    overflow: hidden;
    cursor: pointer;
    transition:
      transform 220ms cubic-bezier(0.22,0.61,0.36,1),
      box-shadow 220ms cubic-bezier(0.22,0.61,0.36,1),
      border-color 200ms.ease-out,
      background 220ms ease-out;
  }
  .ca-feature-card:hover {
    transform: translate3d(0,-4px,0) scale(1.01);
    box-shadow: 0 28px 60px rgba(59,130,246,0.6);
    border-color: rgba(129,140,248,0.9);
    background:
      radial-gradient(circle at top left, rgba(129,140,248,0.38), transparent 60%),
      radial-gradient(circle at bottom right, rgba(249,115,22,0.22), transparent 55%),
      rgba(15,23,42,0.96);
  }

  .ca-feature-icon {
    width: 2.5rem;
    height: 2.5rem;
    border-radius: 0.9rem;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    color: white;
    box-shadow: 0 16px 35px rgba(15,23,42,0.75);
  }

  .ca-feature-cta {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    padding: 0.55rem 1rem;
    font-size: 0.8rem;
    border-radius: 999px;
    background: linear-gradient(90deg,#4f46e5,#6366f1,#f97316);
    color: #fff;
    font-weight: 600;
    box-shadow: 0 16px 32px rgba(79,70,229,0.8);
    text-decoration: none;
    transition:
      transform 160ms ease-out,
      box-shadow 160ms.ease-out,
      filter 160ms ease-out;
  }
  .ca-feature-cta:hover {
    transform: translateY(-1px);
    box-shadow: 0 22px 40px rgba(79,70,229,0.95);
    filter: brightness(1.05);
  }

  /* Detail panel that expands out on hover (desktop) */
  .ca-feature-detail {
    position: absolute;
    top: 0;
    bottom: 0;
    width: 52%;
    padding: 1.2rem 1.3rem;
    border-radius: 1.3rem;
    background: rgba(15,23,42,0.96);
    border: 1px solid rgba(148,163,184,0.6);
    box-shadow: 0 18px 40px rgba(15,23,42,0.9);
    opacity: 0;
    pointer-events: none;
    transform: translate3d(0,8px,0);
    transition:
      opacity 220ms ease-out,
      transform 240ms cubic-bezier(0.22,0.61,0.36,1);
  }
  .ca-feature-detail-left { right: -54%; }
  .ca-feature-detail-right { left: -54%; }

  .ca-feature-card:hover .ca-feature-detail {
    opacity: 1;
    transform: translate3d(0,0,0);
    pointer-events: auto;
  }

  /* Mobile: stack, details appear under card instead of sliding */
  @media (max-width: 900px) {
    .ca-feature-row,
    .ca-feature-row.ca-feature-right {
      justify-content: center;
    }
    .ca-feature-card {
      max-width: 100%;
    }
    .ca-feature-detail,
    .ca-feature-detail-left,
    .ca-feature-detail-right {
      position: static;
      width: 100%;
      margin-top: 0.75rem;
      opacity: 1;
      transform: none;
      pointer-events: auto;
    }
  }
</style>
{% endblock %}
