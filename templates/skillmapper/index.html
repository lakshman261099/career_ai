{% extends "base.html" %}
{% block title %}Skill Mapper{% endblock %}

{% block content %}
<div class="sm-container">
  <div class="sm-header">
    <h1>Skill Mapper</h1>
    <p class="sm-subtitle">Discover your best-fit roles and what‚Äôs hiring now.</p>
  </div>

  <div class="sm-grid">
    <!-- Free panel -->
    <div class="sm-card">
      <div class="sm-card-head">
        <h2>Free run (ü™ô)</h2>
        <p>Paste your skills/interests. We‚Äôll map 3 specialized roles.</p>
      </div>
      <textarea id="sm-free-input" class="sm-textarea" placeholder="e.g., Python, SQL, Tableau, stats, curiosity about business metrics"></textarea>
      <button id="sm-free-btn" class="sm-btn">Run Skill Mapper</button>
      <div class="sm-hint">Free runs use Silver credits. Pro users get unlimited access.</div>
    </div>

    <!-- Pro panel -->
    <div class="sm-card">
      <div class="sm-card-head">
        <h2>Pro analysis (‚≠ê)</h2>
        <p>Use your Profile Portal + latest resume for a deep analysis.</p>
      </div>
      {% if is_pro %}
        <button id="sm-pro-btn" class="sm-btn sm-btn-pro">Analyze from Profile</button>
        <div class="sm-hint">We read your Profile + latest resume on file.</div>
      {% else %}
        <a href="{{ feature_paths.billing }}" class="sm-btn sm-btn-upgrade">Upgrade to Pro</a>
        <div class="sm-hint">Publishing portfolio & Skill Mapper Pro require Pro.</div>
      {% endif %}
    </div>
  </div>

  <div id="sm-results" class="sm-results hidden">
    <div class="sm-results-head">
      <h2>Top 3 Roles</h2>
      <div id="sm-meta" class="sm-meta"></div>
    </div>
    <div id="sm-roles" class="sm-roles"></div>

    <div class="sm-hiring">
      <h3>What‚Äôs hiring now</h3>
      <div id="sm-hiring-strip" class="sm-hiring-strip"></div>
    </div>

    <div class="sm-cta">
      <button id="sm-add-portfolio" class="sm-btn-outline">Add selected micro-project to Portfolio (opens editor)</button>
    </div>
  </div>

  <div id="sm-toast" class="sm-toast hidden"></div>
</div>
{% endblock %}

{% block scripts %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/skillmapper.css') }}">

<!-- Safer JSON export for VS Code (no red squiggles) -->
<script type="application/json" id="sm-config">
  {
    "is_pro": {{ is_pro | tojson }},
    "settings_path": {{ (feature_paths.settings ~ '#projects') | tojson }}
  }
</script>

<script src="{{ url_for('static', filename='js/skillmapper.js') }}"></script>
{% endblock %}
