{% extends "base.html" %}
{% block title %}Skill Mapper ‚Äî CareerAI{% endblock %}

{% block content %}
<section class="mx-auto max-w-4xl px-4 sm:px-6 lg:px-8 pt-12 space-y-6">

  <div class="glass-panel rounded-2xl p-6">
    <div class="flex items-center justify-between mb-3">
      <div>
        <h1 class="text-xl font-bold">Skill Mapper</h1>
        <p class="text-sm text-white/70">
          We read your Profile Portal + resume and map best-fit Indian roles, skills to build, and a realistic roadmap.
        </p>
      </div>
      <a href="{{ url_for('skillmapper.history') }}"
         class="text-xs text-white/70 hover:text-white underline">
        View past Skill Mapper runs
      </a>
    </div>

    {% if profile_snapshot %}
      <div class="mt-3 mb-4 text-xs text-white/70 flex flex-wrap items-center gap-2">
        <span class="px-2 py-1 rounded-full bg-white/5 border border-white/15">
          Profile Portal: {{ profile_snapshot.profile_strength_score or 0 }}% complete
        </span>
        {% if profile_snapshot.missing_sections %}
          <span class="text-white/60">
            Missing: {{ profile_snapshot.missing_sections | join(', ') }}
          </span>
        {% endif %}
        <a href="{{ url_for('settings.profile') }}"
           class="text-[11px] underline hover:text-white ml-auto">
          Update Profile Portal ‚Üí
        </a>
      </div>
    {% endif %}

    <form method="POST">
      <div class="space-y-4">
        <div>
          <label class="block text-sm mb-1">
            Extra skills &amp; interests (optional)
          </label>
          <textarea name="free_text_skills" rows="5"
            class="w-full rounded-xl px-3 py-2 bg-white/10 border border-white/20 focus:outline-none focus:ring-2 focus:ring-emerald-400/70"
            placeholder="e.g., Python, SQL, data structures, web dev, ML basics, interested in product-based companies"></textarea>
          <p class="text-[11px] text-white/50 mt-1">
            Profile Portal + resume stay the main source. Use this to nudge toward tools, coursework or interests.
          </p>
        </div>

        <div>
          <label class="block text-sm mb-1">
            Target domain (optional)
          </label>
          <input
            type="text"
            name="target_domain"
            class="w-full rounded-xl px-3 py-2 bg-white/10 border border-white/20 focus:outline-none focus:ring-2 focus:ring-emerald-400/70"
            placeholder="e.g., Bangalore ¬∑ product companies, fintech, cloud data roles" />
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div>
            <label class="block text-sm mb-1">
              Region / sector emphasis
            </label>
            <input
              type="text"
              name="region_focus"
              class="w-full rounded-xl px-3 py-2 bg-white/10 border border-white/20 focus:outline-none focus:ring-2 focus:ring-emerald-400/70"
              placeholder="Default: India ¬∑ early-career tech roles" />
            <p class="text-[11px] text-white/50 mt-1">
              Example: ‚ÄúBangalore ¬∑ data engineer‚Äù or ‚ÄúIndia ¬∑ product analytics‚Äù.
            </p>
          </div>

          <div>
            <label class="block text-sm mb-1">
              Time horizon for change
            </label>
            <select
              name="time_horizon"
              class="w-full rounded-xl px-3 py-2 bg-white/10 border border-white/20 focus:outline-none focus:ring-2 focus:ring-emerald-400/70">
              <option value="3">3 months ¬∑ quick wins</option>
              <option value="6" selected>6 months ¬∑ realistic step up</option>
              <option value="9">9 months ¬∑ deeper shift</option>
              <option value="12">12 months ¬∑ big pivot</option>
            </select>
            <p class="text-[11px] text-white/50 mt-1">
              Used in Pro runs to size learning plans &amp; micro-projects.
            </p>
          </div>
        </div>

        <div class="mt-2 flex items-center gap-3 text-sm">
          <label class="inline-flex items-center gap-2">
            <input type="radio" name="mode" value="free" {% if mode != 'pro' %}checked{% endif %}>
            <span>Free roadmap (ü™ô)</span>
          </label>
          <label class="inline-flex items-center gap-2">
            <input type="radio" name="mode" value="pro" {% if mode == 'pro' %}checked{% endif %}
              {% if not is_pro_user %}disabled{% endif %}>
            <span class="{% if not is_pro_user %}text-white/40{% endif %}">
              Deep roadmap (Pro ‚≠ê)
            </span>
          </label>
        </div>

        {% if not is_pro_user %}
          <p class="text-[11px] text-white/55 mt-1">
            Deep roadmap requires an active Pro plan. You can still run Free mode using Silver coins.
          </p>
        {% endif %}

        <div class="mt-4 flex flex-wrap gap-2">
          <button class="btn-primary" type="submit">Analyze</button>
          <a class="btn-ghost" href="{{ feature_paths.billing }}">Get Pro</a>
        </div>
      </div>
    </form>
  </div>

</section>
{% endblock %}
